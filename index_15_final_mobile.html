
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>StudyGO タイプ診断（スマホ対応版）</title>
  <style>
    body {
      font-family: 'Segoe UI', 'メイリオ', sans-serif;
      background: #f9f9ff;
      padding: 20px;
      color: #333;
      max-width: 600px;
      margin: auto;
    }
    .question {
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 0 8px rgba(0,0,0,0.05);
      margin-bottom: 20px;
    }
    button {
      display: block;
      width: 100%;
      margin: 10px 0;
      padding: 14px;
      font-size: 16px;
      border-radius: 8px;
      border: 1px solid #ccc;
      background: #eef3ff;
      cursor: pointer;
    }
    button:hover {
      background-color: #d0e0ff;
    }
    .result-title {
      background: #e0f0ff;
      border-left: 6px solid #2a7ae2;
      padding: 12px;
      font-size: 20px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
      border-radius: 6px;
    }
    #result {
      margin-top: 30px;
      text-align: center;
    }
    #result img {
      margin-top: 16px;
      width: 90%;
      max-width: 400px;
      border-radius: 10px;
    }
    .link-button {
      display: block;
      width: 100%;
      margin: 12px 0;
      padding: 14px;
      font-size: 16px;
      border-radius: 8px;
      background: #4a90e2;
      color: white;
      text-decoration: none;
      text-align: center;
    }
    .note {
      font-size: 13px;
      color: #666;
      margin-top: 12px;
    }
  </style>
</head>
<body>

<h1>📋 あなたに最適な勉強場所は？</h1>
<div id="quiz"></div>
<div id="result"></div>

<script>
const questions = Array.from({ length: 15 }, (_, i) => ({
  text: `質問 ${i + 1}：この設問はカスタマイズされていますか？`,
  answers: [
    { text: "選択肢 A", score: { jishushitsu: 1 } },
    { text: "選択肢 B", score: { toshokan: 1 } },
    { text: "選択肢 C", score: { coworking: 1, cafe: 1, family: 1 } }
  ]
}));

let current = 0;
let score = { jishushitsu: 0, toshokan: 0, coworking: 0, cafe: 0, family: 0 };

const quiz = document.getElementById("quiz");
const result = document.getElementById("result");

function showQuestion() {
  const q = questions[current];
  quiz.innerHTML = `<div class="question"><p><strong>Q${current + 1}.</strong> ${q.text}</p></div>`;
  q.answers.forEach((a) => {
    const btn = document.createElement("button");
    btn.textContent = a.text;
    btn.onclick = () => {
      Object.keys(a.score).forEach(type => score[type] += a.score[type]);
      current++;
      if (current < questions.length) {
        showQuestion();
      } else {
        showResult();
      }
    };
    quiz.appendChild(btn);
  });
}

function showResult() {
  const max = Math.max(...Object.values(score));
  const type = Object.keys(score).find(k => score[k] === max);
  const names = {
    jishushitsu: "有料自習室",
    toshokan: "図書館",
    coworking: "コワーキングスペース",
    cafe: "カフェ",
    family: "ファミリーレストラン"
  };
  const images = {
    jishushitsu: "https://source.unsplash.com/600x400/?study,desk",
    toshokan: "https://source.unsplash.com/600x400/?library,books",
    coworking: "https://source.unsplash.com/600x400/?coworking,office",
    cafe: "https://source.unsplash.com/600x400/?cafe,coffee",
    family: "https://source.unsplash.com/600x400/?diner,restaurant"
  };

  let resultHTML = `
    <div class="result-title">🎯 あなたに最適なのは【${names[type]}】タイプ！</div>
    <img src="${images[type]}" alt="${names[type]}のイメージ">
    <a href="https://studygo.jp" target="_blank" class="link-button">▶ 掲載店舗を見る</a>
  `;

  if (["cafe", "family", "toshokan"].includes(type)) {
    navigator.geolocation.getCurrentPosition(function(pos) {
      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;
      const query = encodeURIComponent(names[type]);
      const mapURL = `https://www.google.com/maps/search/${query}/@${lat},${lng},15z`;
      result.innerHTML = resultHTML + `
        <a href="${mapURL}" target="_blank" class="link-button">📍 周辺の${names[type]}をGoogleマップで探す</a>
        <p class="note">※ 現在、StudyGOでは図書館・カフェ・ファミレスの掲載はありません。順次拡大中です。</p>
      `;
    }, function() {
      result.innerHTML = resultHTML + `
        <p class="note">※ 位置情報の取得に失敗しました。<br>現在、StudyGOでは図書館・カフェ・ファミレスの掲載はありません。順次拡大中です。</p>
      `;
    });
  } else {
    result.innerHTML = resultHTML;
  }

  quiz.innerHTML = "";
}

showQuestion();
</script>

</body>
</html>
